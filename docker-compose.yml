version: '3'

services:
  gen:
    container_name: gen
    build:
      context: .
    restart: "on-failure" 
    env_file: ./config/env-dev-local
    volumes:
      - ./app:/gen/app:rw
      - ./static:/gen/static
      - ./media:/gen/media
    command: gunicorn GEN.asgi:application --workers 2 --bind :8000 --worker-class uvicorn.workers.UvicornWorker
    ports:
      - 8000:8000

#  nginx:
#    container_name: gen_nginx
#    image: nginx:1.19-alpine
#    restart: "on-failure"
#    ports:
#      - 80:80
#    volumes:
#      - ./config/nginx:/etc/nginx/conf.d
#      - ./static:/gen/static
#      - ./media:/gen/media
#    depends_on:
#      - gen
#    networks:
#      - nginx_network


#networks:
#  nginx_network:
#    driver: bridge
